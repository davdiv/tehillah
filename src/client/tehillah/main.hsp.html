<!--
    Tehillah: Web-based application to manage and display worship songs.
    https://github.com/davdiv/tehillah
    Copyright (C) 2014 DivDE <divde@free.fr>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<script>
var songEditor = require("./song/song-editor.hsp.html");
var displaySong = require("./song/song-display.hsp.html");
var dropZone = require("../generic/components/drop-zone.hsp.html");
var readFileAsText = require("../generic/functions/readFileAsText");
var songImport = require("./song/opensong-import").parseFile;

var data = {
song:{lyrics:[]}
};

var drop = function(event) {
var file = event.dataTransfer.files[0];
readFileAsText(file).then(function (textFile) {
var song = songImport(textFile);
data.song = song;
}).done();
};

</script>

<template id="main">
  <div class="container-fluid">
    <div class="page-header">
      <h1>Tehillah</h1>
    </div>
    <#dropZone onDrop="{drop($event)}">
       <@dragDisplay>Drop this file here</@dragDisplay>
       <@normalDisplay>Drag an OpenSong file here</@normalDisplay>
    </#dropZone>
    <div class="row">
    <div class="col-md-6">
    <div class="container-fluid">
    <#songEditor song="{data.song}"/>
    </div>
    </div>
    <div class="col-md-6">
    <div class="container-fluid">
    <#displaySong song="{data.song}"/>
    </div>
    </div>
    </div>
  </div>
</template>

<script>
module.exports = main;
</script>
