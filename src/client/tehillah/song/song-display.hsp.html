<script>
var klass = require("hsp/klass");
var SongDisplayCtrl = klass({
	$attributes: {
		"song": {
			type: "object",
			binding: "1-way"
		},
		"onVerseClick": {
			type: "callback"
		},
		"selectedVerse": {
			type: "int",
			binding: "1-way",
			defaultValue: -1
		},
		"showSelectedVerseOnly": {
			type: "boolean",
			binding: "1-way",
			defaultValue: false
		}
	}
});
</script>

<template id="displayVerse" args="ctrl, verseIndex">
{let verse = ctrl.song.lyrics[verseIndex]}
{if verse}
<p class="song-verse {ctrl.onVerseClick.empty?'':'clickable'} {ctrl.selectedVerse == verseIndex && !ctrl.showSelectedVerseOnly?'active':''}" onclick="{ctrl.onVerseClick({index: verseIndex})}">
{foreach line in verse.lines}
{foreach lyrics in line.lyrics}{lyrics}{/foreach}<br>
{/foreach}
</p>
{/if}
</template>

<template id="displaySong" ctrl="SongDisplayCtrl as ctrl">
<div>
<h3>{ctrl.song.title} <small>{ctrl.song.author}</small></h3>
{if ctrl.showSelectedVerseOnly}
<#displayVerse ctrl="{ctrl}" verseIndex="{ctrl.selectedVerse}"/>
{else}
{foreach verseIndex,verse in ctrl.song.lyrics}
<#displayVerse ctrl="{ctrl}" verseIndex="{verseIndex}"/>
{/foreach}
{/if}
{if ctrl.song.copyright}
<p class="text-muted">
<small>{ctrl.song.copyright}</small>
</p>
{/if}
<div><h4></h4></div>
</div>
</template>

<script>
module.exports = displaySong;
</script>
